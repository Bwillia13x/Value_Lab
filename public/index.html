<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Value Lab â€“ Fund Viewer</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 720px; margin: 2rem auto; }
    #chart { width: 100%; height: 400px; }
  </style>
</head>
<body>
  <h1>Fund Return Viewer</h1>
  <label>Ticker: <input id="ticker" value="SPY" /></label>
  <button id="load">Load</button>
  <canvas id="chart"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('chart').getContext('2d');
    let myChart;
    async function fetchData(ticker) {
      const res = await fetch('/fund/' + encodeURIComponent(ticker));
      if (!res.ok) throw new Error('API error');
      return res.json();
    }
    function draw(series) {
      const labels = series.map(d => d.date);
      const data = series.map(d => d.index);
      if (myChart) myChart.destroy();
      myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels,
          datasets: [{ label: 'Index (base 100)', data, borderColor: '#2196f3', borderWidth: 2, fill: false }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: { x: { ticks: { maxTicksLimit: 12 } } }
        }
      });
    }
    document.getElementById('load').addEventListener('click', async () => {
      const t = document.getElementById('ticker').value.trim();
      if (!t) return;
      document.getElementById('load').disabled = true;
      try {
        const series = await fetchData(t);
        draw(series);
      } catch (e) {
        alert(e.message || e);
      } finally {
        document.getElementById('load').disabled = false;
      }
    });
    // auto-load default ticker
    document.getElementById('load').click();
  </script>
</body>
</html> 